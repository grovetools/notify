{
  "sections": {
    "configuration": {
      "title": "Configuration",
      "content": "",
      "subsections": [
        {
          "title": "Configuration",
          "content": "Configuration for `notify` is handled through command-line flags passed to its subcommands. The tool does not read configuration from environment variables or dedicated configuration files.\n\n### Notification Backends\n\nThe tool supports two notification backends, selected by the subcommand used:\n\n*   **`system`**: Utilizes the host operating system's native notification mechanism by executing `osascript` on macOS and `notify-send` on Linux.\n*   **`ntfy`**: Sends an HTTP POST request to a specified [ntfy.sh](https://ntfy.sh) server instance.\n\n### System Notification Configuration (`notify system`)\n\nThe `notify system` command accepts the following flags:\n\n*   `--title \u003cstring\u003e`: Sets the notification title. Defaults to \"Grove Notification\".\n*   `--level \u003cstring\u003e`: Sets the notification level, which is prepended to the title. Accepted values are `info`, `warning`, `error`. Defaults to `info`.\n\n### Ntfy Notification Configuration (`notify ntfy`)\n\nThe `notify ntfy` command sends metadata to the ntfy server via HTTP headers. It accepts the following flags:\n\n*   `--url \u003cstring\u003e`: The base URL of the ntfy server. Defaults to `https://ntfy.sh`.\n*   `--topic \u003cstring\u003e`: The ntfy topic to publish the message to. This flag is required.\n*   `--title \u003cstring\u003e`: Sets the notification title via the `Title` HTTP header. Defaults to \"Grove Notification\".\n*   `--priority \u003cstring\u003e`: Sets the message priority via the `Priority` HTTP header. Accepted values are `min`, `low`, `default`, `high`, `urgent`. Defaults to `default`.\n*   `--tags \u003cstring\u003e`: A comma-separated list of tags sent via the `Tags` HTTP header.\n\n### Examples\n\n#### System Notification\n\nTo send a local system notification about a failed build:\n\n#### Remote Ntfy Notification\n\nTo send a notification to an ntfy topic for a successful deployment event:\n\n#### Self-Hosted Ntfy Instance\n\nTo send a notification to a self-hosted ntfy server:",
          "code_blocks": [
            "notify system --title \"Build Failed\" --level error \"Compilation failed in package main.\"",
            "notify ntfy \\\n  --topic \"ci-cd-events\" \\\n  --title \"Deployment Succeeded\" \\\n  --priority high \\\n  --tags \"prod,deploy\" \\\n  \"Version v1.4.1 deployed to production cluster.\"",
            "notify ntfy \\\n  --url \"http://ntfy.internal.corp\" \\\n  --topic \"dev-alerts\" \\\n  \"Database migration complete on staging.\""
          ]
        }
      ]
    },
    "overview": {
      "title": "Overview",
      "content": "`notify` is a command-line tool and Go library for dispatching local system alerts and remote push notifications. It abstracts operating system specifics and remote API details, providing a unified interface for signaling events within the Grove ecosystem.",
      "subsections": [
        {
          "title": "Core Mechanisms",
          "content": "**System Abstraction**: The tool detects the host operating system to execute the appropriate native command for desktop notifications:\n*   **macOS**: Executes `osascript` to trigger AppleScript notifications.\n*   **Linux**: Executes `notify-send` via `libnotify`.\n\n**Remote Dispatch**: Supports `ntfy` for sending push notifications to mobile devices or remote desktops. It constructs HTTP POST requests with support for priorities, tags, and titles, targeting either the public `ntfy.sh` service or self-hosted instances.\n\n**Configuration Integration**: Uses `grove core` to read configuration from `grove.yml`. Settings are defined under the `notifications` extension key, allowing project-specific or user-specific overrides for topics and filtering levels."
        },
        {
          "title": "Features",
          "content": "*   **`notify system`**: triggers a local desktop notification. Useful for signaling the completion of long-running shell scripts.\n*   **`notify ntfy`**: sends a payload to an ntfy topic. Supports flags for `--priority`, `--tags`, and `--title`."
        },
        {
          "title": "Integration with Grove Hooks",
          "content": "`notify` serves as the alerting layer for `grove hooks`.\n\n**Lifecycle Alerts**: When an interactive agent (managed by `flow` or `hooks`) changes state, `hooks` utilizes the `notify` package to alert the user.\n*   **Job Ready**: When a background job (e.g., `headless_agent`) completes or pauses for user input (`pending_user`), a notification is triggered.\n*   **Agent Idle**: When an interactive agent finishes a turn and awaits instructions, `notify` signals that the terminal requires attention.\n\n**Context Propagation**: Notifications sent via `hooks` include metadata derived from the session context, such as the Plan Name, Job Title, and Repository/Worktree, allowing users to distinguish between multiple concurrent agent sessions."
        },
        {
          "title": "Configuration",
          "content": "Configuration is managed via `grove.yml` under the `notifications` extension.",
          "code_blocks": [
            "extensions:\n  notifications:\n    ntfy:\n      enabled: true\n      topic: \"my-private-topic\"\n      url: \"https://ntfy.sh\" # Optional, defaults to official server\n    system:\n      levels: [\"error\", \"warning\"] # Only show system alerts for these levels"
          ]
        }
      ]
    }
  }
}